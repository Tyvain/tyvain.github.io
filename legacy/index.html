<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CV - Sylvain Auger-Léger</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-color: #2c3e50;
        --secondary-color: #3498db;
        --light-color: #ecf0f1;
        --dark-color: #2c3e50;
        --text-color: #333;
        --text-light: #7f8c8d;
        --background-color: #f5f7fa;
        --white-color: #ffffff;
        --border-color: #e0e0e0;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Lato", sans-serif;
        line-height: 1.6;
        color: var(--text-color);
        background-color: var(--background-color);
      }

      .container {
        max-width: 1100px;
        margin: 2rem auto;
        background: var(--white-color);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        display: flex;
        overflow: hidden;
      }

      .sidebar {
        width: 35%;
        background-color: var(--primary-color);
        color: var(--light-color);
        padding: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .main-content {
        width: 65%;
        padding: 3rem;
      }

      .profile-photo {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        border: 5px solid var(--secondary-color);
        margin-bottom: 1.5rem;
      }

      .sidebar-section {
        width: 100%;
        margin-bottom: 2rem;
      }

      .sidebar-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.3rem;
        color: var(--white-color);
        border-bottom: 2px solid var(--secondary-color);
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
        text-transform: uppercase;
      }

      .contact-info a {
        color: var(--light-color);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 0.8rem;
        margin-bottom: 0.8rem;
        font-size: 0.9rem;
        transition: color 0.3s ease;
      }

      .contact-info a:hover {
        color: var(--secondary-color);
      }

      .contact-info i {
        width: 20px;
        text-align: center;
      }

      .skills-list {
        list-style: none;
        padding: 0;
      }

      .skills-list li {
        padding: 0.3rem 0;
        font-size: 0.9rem;
      }

      .header {
        margin-bottom: 3rem;
      }

      h1 {
        font-family: "Montserrat", sans-serif;
        font-size: 2.8rem;
        margin: 0;
        color: var(--dark-color);
        text-transform: uppercase;
        letter-spacing: 1.5px;
      }

      .title {
        font-size: 1.2rem;
        margin: 0.2rem 0 0.5rem 0;
        color: var(--secondary-color);
        font-weight: 700;
      }

      .degree {
        font-size: 1rem;
        color: var(--text-light);
        font-weight: 400;
      }

      .section {
        margin-bottom: 2.5rem;
      }

      .section-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.5rem;
        color: var(--primary-color);
        border-bottom: 3px solid var(--secondary-color);
        padding-bottom: 0.5rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.8rem;
      }

      .section-title i {
        color: var(--secondary-color);
      }

      .experience-item {
        margin-bottom: 2rem;
        padding-left: 1.5rem;
        border-left: 3px solid var(--secondary-color);
        position: relative;
      }

      .experience-item::before {
        content: "";
        position: absolute;
        left: -8px;
        top: 5px;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background-color: var(--secondary-color);
        border: 2px solid var(--white-color);
      }

      .job-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--dark-color);
      }

      .company {
        font-weight: 700;
        color: var(--text-color);
      }

      .date {
        color: var(--text-light);
        font-style: italic;
        margin-bottom: 0.5rem;
      }

      ul.tasks {
        list-style-type: none;
        padding-left: 0;
      }

      ul.tasks li {
        position: relative;
        padding-left: 1.2rem;
        margin-bottom: 0.5rem;
      }

      ul.tasks li:before {
        content: "▸";
        color: var(--secondary-color);
        position: absolute;
        left: 0;
        font-size: 1.2rem;
        line-height: 1;
      }

      footer {
        text-align: center;
        margin-top: 2rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border-color);
        color: var(--text-light);
        font-size: 0.8rem;
      }

      @media (max-width: 992px) {
        .container {
          flex-direction: column;
          margin: 0;
          border-radius: 0;
        }
        .sidebar,
        .main-content {
          width: 100%;
        }
        .main-content {
          padding: 2rem;
        }
        h1 {
          font-size: 2.2rem;
        }
      }

      @media print {
        body {
          font-size: 10pt;
          background-color: var(--white-color);
        }
        .container {
          flex-direction: column;
          box-shadow: none;
          margin: 0;
          padding: 0;
          width: 100%;
          max-width: 100%;
        }
        .sidebar {
          width: 100%;
          background-color: var(--white-color) !important;
          color: var(--dark-color) !important;
          padding: 0 0 1rem 0;
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }
        .main-content {
          width: 100%;
          padding: 0;
        }
        .profile-photo {
          display: none;
        }
        .sidebar-title {
          color: var(--primary-color);
        }
        .contact-info a {
          color: var(--dark-color);
        }
        .skills-list li {
          color: var(--text-color);
        }
        .header {
          padding: 1rem;
          margin: 0;
          text-align: center;
          background: var(--light-color);
        }
        h1 {
          font-size: 2rem;
        }
        .title,
        .degree {
          color: var(--dark-color);
        }
        .section {
          page-break-inside: avoid;
        }
        footer {
          display: none;
        }
      }

      /* Floating button style */
      #downloadPdfBtn {
        position: fixed;
        bottom: 25px;
        right: 25px;
        background-color: var(--secondary-color);
        color: white;
        border: none;
        border-radius: 50%;
        width: 56px;
        height: 56px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        transition: background-color 0.3s ease;
      }
      #downloadPdfBtn:hover {
        background-color: #217dbb;
      }

      #downloadImageBtn {
        background-color: #3498db;
        margin-bottom: 10px;
      }

      #downloadImageBtn:hover, #downloadPdfBtn:hover {
        transform: scale(1.1);
      }

      #downloadImageBtn:hover {
        background-color: #2980b9;
      }

      #downloadPdfBtn:hover {
        background-color: #c0392b;
      }

      .floating-buttons {
        position: fixed;
        bottom: 30px;
        left: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        z-index: 1000;
      }

      .download-options {
        display: none;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 10px;
        background: white;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      }

      .download-options button {
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        background-color: #3498db;
        color: white;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .download-options button:hover {
        background-color: #2980b9;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <aside class="sidebar">
        <img src="./me.jpg" alt="Photo de profil" class="profile-photo" />

        <div class="sidebar-section contact-info">
          <h3 class="sidebar-title">Contact</h3>
          <a href="tel:+687805868"><i class="fas fa-phone"></i> +687 80 58 68</a>
          <a href="mailto:sylvain.auger-leger@unc.nc"
            ><i class="fas fa-envelope"></i> sylvain.auger-leger@unc.nc</a
          >
          <a href="https://github.com/tyvain" target="_blank"
            ><i class="fab fa-github"></i> github.com/tyvain</a
          >
        </div>

        <div class="sidebar-section">
          <h3 class="sidebar-title">Compétences</h3>
          <ul class="skills-list">
            <li>
              <b>Gestion de Projet:</b> PMBOK, Itil, Prince2, Lean, Scrum,
              Kanban
            </li>
            <li><b>DevOps:</b> GitLab CI/CD, Kubernetes</li>
            <li><b>Développement:</b> Java, Spring, Spring Boot</li>
            <li><b>Système:</b> Linux, Windows, Virtualisation</li>
            <li><b>Soft Skills:</b> Autonomie, Service client, Rigueur,
              Vulgarisation</li>
          </ul>
        </div>

        <div class="sidebar-section">
          <h3 class="sidebar-title">Langues</h3>
          <ul class="skills-list">
            <li>Français (Natif)</li>
            <li>Anglais (Courant)</li>
          </ul>
        </div>

        <div class="sidebar-section">
          <h3 class="sidebar-title">Sports</h3>
          <ul class="skills-list">
            <li>Natation, Surf, Wingfoil, Football</li>
          </ul>
        </div>
      </aside>

      <main class="main-content">
        <header class="header">
          <h1>Sylvain Auger-Léger</h1>
          <h2 class="title">Chef de Projet Informatique - Urbaniste SI - DevOps</h2>
          <div class="degree">Master's Degree in Software Engineering</div>
        </header>

        <section class="section">
          <h2 class="section-title">
            <i class="fas fa-briefcase"></i> Expérience Professionnelle
          </h2>

          <div class="experience-item">
            <div class="job-title">
              Chef de projet / Urbaniste SI / DevOps
            </div>
            <div class="company">Université de la Nouvelle-Calédonie</div>
            <div class="date">2018 - à ce jour</div>
            <ul class="tasks">
              <li>
                Pilotage de la mise en place d'un système d'aide à la décision (SID) complet.
              </li>
              <li>
                Responsable de la mise en œuvre d'une usine logicielle moderne (GitLab CI/CD, Kubernetes).
              </li>
              <li>
                Coordination des audits de sécurité et du plan d'action correctif (ANSSI).
              </li>
              <li>Contribution au développement de la maturité ITIL/ITSM.</li>
              <li>Accompagnement et formation des équipes aux pratiques DevOps.</li>
              <li>Support de niveau 3 technique et fonctionnel.</li>
              <li>
                Enseignement du cours "Gestion de Projets Informatiques et gouvernance IT".
              </li>
            </ul>
          </div>
          <div class="experience-item">
            <div class="job-title">Responsable de la Division Fiscalité</div>
            <div class="company">Direction du numérique (DINUM)</div>
            <div class="date">2013 - 2018</div>
            <ul class="tasks">
              <li>Encadrement et animation d’une équipe de 8 ingénieurs.</li>
              <li>
                Pilotage stratégique du portefeuille de projets numériques liés à la fiscalité.
              </li>
              <li>Gestion de projets à fort impact national (portail de télédéclaration, etc.).</li>
            </ul>
          </div>
          <div class="experience-item">
            <div class="job-title">Ingénieur Développeur (Spring / Java)</div>
            <div class="company">Multiples contextes (Service Public, Startups, Freelance)</div>
            <div class="date">2007 - 2013</div>
          </div>
        </section>
      </main>
    </div>

    <!-- Floating download buttons -->
    <div class="floating-buttons">
      <button id="downloadImageBtn" title="Télécharger en image" aria-label="Télécharger en image">
        <i class="fas fa-camera"></i>
      </button>
      <div class="download-options">
        <button data-format="png">PNG</button>
        <button data-format="jpeg">JPG</button>
      </div>
      <button id="downloadPdfBtn" title="Télécharger en PDF" aria-label="Télécharger en PDF">
        <i class="fas fa-file-pdf"></i>
      </button>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Configuration pour le bouton d'image
        const downloadImageBtn = document.getElementById('downloadImageBtn');
        const downloadOptions = document.querySelector('.download-options');
        const container = document.querySelector('.container');

        // Afficher/cacher les options de téléchargement
        downloadImageBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          downloadOptions.style.display = downloadOptions.style.display === 'flex' ? 'none' : 'flex';
        });

        // Gestion du téléchargement d'image
        downloadOptions.querySelectorAll('button').forEach(button => {
          button.addEventListener('click', async function(e) {
            e.stopPropagation();
            const format = this.dataset.format;
            
            try {
              // Masquer les boutons pendant la capture
              const buttons = document.querySelectorAll('.floating-buttons button');
              buttons.forEach(btn => {
                btn.style.opacity = '0';
              });
              
              console.log('Début de la capture...');
              
              // Options de capture
              const options = {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                logging: true, // Activer les logs pour le débogage
                backgroundColor: null,
                onclone: function(clonedDoc) {
                  console.log('Document cloné pour capture');
                }
              };
              
              console.log('Options de capture :', options);
              
              // Capturer le conteneur principal
              const canvas = await html2canvas(container, options);
              
              if (!canvas) {
                throw new Error('La capture a échoué : canvas non créé');
              }
              
              console.log('Capture terminée, création du lien de téléchargement...');
              
              // Créer un lien de téléchargement
              const link = document.createElement('a');
              const fileName = `CV-Sylvain-Auger-Leger.${format}`;
              link.download = fileName;
              
              // Convertir le canvas en URL de données
              const dataUrl = canvas.toDataURL(`image/${format}`, 1.0);
              if (!dataUrl || dataUrl === 'data:,') {
                throw new Error('Échec de la conversion en image');
              }
              
              link.href = dataUrl;
              console.log('Lien de téléchargement créé pour :', fileName);
              
              // Déclencher le téléchargement
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            } catch (error) {
              console.error('Erreur détaillée :', {
                message: error.message,
                name: error.name,
                stack: error.stack,
                error: error
              });
              alert(`Erreur lors de la capture : ${error.message || 'Veuillez réessayer'}`);
            } finally {
              // Réafficher les boutons
              document.querySelectorAll('.floating-buttons button').forEach(btn => {
                btn.style.opacity = '1';
              });
              downloadOptions.style.display = 'none';
            }
          });
        });

        // Fermer les options quand on clique ailleurs
        document.addEventListener('click', function() {
          downloadOptions.style.display = 'none';
        });

        // Configuration pour le bouton PDF existant
        const pdfButton = document.getElementById("downloadPdfBtn");
        pdfButton.addEventListener("click", async () => {
          try {
            // Masquer les boutons pendant la capture
            document.querySelectorAll('.floating-buttons button').forEach(btn => {
              btn.style.opacity = '0';
            });
            
            // Utilisation d'html2canvas pour capturer la page
            const canvas = await html2canvas(container, {
              scale: 2,
              useCORS: true,
              allowTaint: true,
              logging: false,
              backgroundColor: null
            });
            
            const imgData = canvas.toDataURL("image/png");
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF({
              unit: "mm",
              format: "a4",
            });

            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

            pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
            pdf.save("CV_Sylvain_Auger-Leger.pdf");
          } catch (error) {
            console.error('Erreur lors de la génération du PDF :', error);
            alert('Une erreur est survenue lors de la génération du PDF.');
          } finally {
            // Réafficher les boutons
            document.querySelectorAll('.floating-buttons button').forEach(btn => {
              btn.style.opacity = '1';
            });
          }
        });
      });
    </script>
</body>
</html>
